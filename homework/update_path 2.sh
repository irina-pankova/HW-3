#!/bin/bash
# --- –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø–µ—Ä–µ–¥–∞–Ω –ª–∏ –∞—Ä–≥—É–º–µ–Ω—Ç ---
if [ -z "$1" ]; then
    echo "‚ùó –£–∫–∞–∂–∏—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é, –∫–æ—Ç–æ—Ä—É—é –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ PATH."
    echo "–ü—Ä–∏–º–µ—Ä: ./update_path.sh /Users/irinapankova/Desktop/git_class/HW-3/homework"
    exit 1
fi

NEW_DIR="$1"

# --- 1. –í—ã–≤–æ–¥–∏–º —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ PATH ---
echo "üîπ –¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ PATH:"
echo "$PATH"
echo

# --- 2. –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –≤–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–π PATH ---
export PATH="$PATH:$NEW_DIR"

echo "‚úÖ –ù–æ–≤–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è '$NEW_DIR' –≤—Ä–µ–º–µ–Ω–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ PATH."
echo
echo "üîπ –¢–µ–ø–µ—Ä—å PATH –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:"
echo "$PATH"
echo

# --- 3. –ü–æ–¥—Å–∫–∞–∑–∫–∞, –∫–∞–∫ —Å–¥–µ–ª–∞—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º ---
echo "‚ÑπÔ∏è  –ò–∑–º–µ–Ω–µ–Ω–∏—è, —Å–¥–µ–ª–∞–Ω–Ω—ã–µ —ç—Ç–æ–π –∫–æ–º–∞–Ω–¥–æ–π, –¥–µ–π—Å—Ç–≤—É—é—Ç —Ç–æ–ª—å–∫–æ –¥–æ –∑–∞–∫—Ä—ã—Ç–∏—è —Ç–µ—Ä–º–∏–Ω–∞–ª–∞."
echo "–ß—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –≤ PATH –Ω–∞–≤—Å–µ–≥–¥–∞, –¥–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â—É—é —Å—Ç—Ä–æ–∫—É –≤ —Ñ–∞–π–ª ~/.bashrc:"
echo
echo "    export PATH=\"\$PATH:$NEW_DIR\""
echo
echo "–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –ø—Ä–∏–º–µ–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥–æ–π:"
echo
echo "    source ~/.bashrc"
echo
echo "–∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Ä–º–∏–Ω–∞–ª."

# --- 4. –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º –¥–æ–±–∞–≤–∏—Ç—å –ø—É—Ç—å –≤ PATH –Ω–∞–≤—Å–µ–≥–¥–∞ ---
CONFIG_FILE="$HOME/.bashrc"
if [ -n "$ZSH_VERSION" ]; then
    CONFIG_FILE="$HOME/.zshrc"
fi

read -p "–•–æ—Ç–∏—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å '$NEW_DIR' –≤ PATH –Ω–∞–≤—Å–µ–≥–¥–∞ (–≤ $CONFIG_FILE)? [y/N] " answer
if [[ "$answer" =~ ^[Yy]$ ]]; then
    echo "export PATH=\"\$PATH:$NEW_DIR\"" >> "$CONFIG_FILE"
    echo "‚úÖ –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ $CONFIG_FILE."
    echo "–ß—Ç–æ–±—ã –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ: source $CONFIG_FILE"
else
    echo "‚è≠  –ò–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª."
fi

#(–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ü—Ä–æ–≤–µ—Ä–∫—É, –µ—Å—Ç—å –ª–∏ –ø—É—Ç—å —É–∂–µ –≤ PATH, —á—Ç–æ–±—ã –Ω–µ –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å
if [[ ":$PATH:" == *":$NEW_DIR:"* ]]; then
    echo "‚ö†Ô∏è  –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è '$NEW_DIR' —É–∂–µ –µ—Å—Ç—å –≤ PATH."
else
    export PATH="$PATH:$NEW_DIR"
    echo "‚úÖ –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è '$NEW_DIR' –≤—Ä–µ–º–µ–Ω–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ PATH."
fi
